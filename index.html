<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Driver Chat Simple</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: auto; padding: 20px; }
        #messages { border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
        #msgInput { width: 75%; padding: 8px; }
        #sendBtn { width: 20%; padding: 8px; }
        #nameForm { margin-bottom: 15px; }
        #chatArea { display: none; }
    </style>
</head>
<body>

<h2>ðŸ“¨ Driver Chat Simple</h2>

<div id="nameForm">
    <input type="text" id="driverName" placeholder="Enter your name" />
    <button id="startChatBtn">Start Chat</button>
</div>

<div id="chatArea">
    <div id="messages"></div>
    <input id="msgInput" placeholder="Type a message..." />
    <button id="sendBtn">Send</button>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAdOVgJ0Wstt1-l72haF_nQFo--7TfMVns",
        authDomain: "driver-chat-75c62.firebaseapp.com",
        databaseURL: "https://driver-chat-75c62-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "driver-chat-75c62",
        storageBucket: "driver-chat-75c62.firebasestorage.app",
        messagingSenderId: "703941189790",
        appId: "1:703941189790:web:2ea2fcdef03cef0123db8f"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const nameForm = document.getElementById('nameForm');
    const driverNameInput = document.getElementById('driverName');
    const startChatBtn = document.getElementById('startChatBtn');

    const chatArea = document.getElementById('chatArea');
    const messagesDiv = document.getElementById('messages');
    const msgInput = document.getElementById('msgInput');
    const sendBtn = document.getElementById('sendBtn');

    let driverName = localStorage.getItem('driverName') || "";

    function showChat() {
        nameForm.style.display = 'none';
        chatArea.style.display = 'block';
    }

    if (driverName) {
        driverNameInput.value = driverName;
        showChat();
    }

    startChatBtn.onclick = () => {
        const name = driverNameInput.value.trim();
        if (!name) {
            alert("Please enter your name.");
            return;
        }
        driverName = name;
        localStorage.setItem('driverName', driverName);
        showChat();
    };

    sendBtn.onclick = () => {
        const text = msgInput.value.trim();
        if (text.length > 0) {
            db.ref("messages").push({
                text: text,
                time: new Date().toLocaleTimeString(),
                sender: driverName
            });
            msgInput.value = "";
        }
    };

    db.ref("messages").on("child_added", snapshot => {
        const msg = snapshot.val();
        const p = document.createElement("p");
        p.textContent = `[${msg.time}] ${msg.sender || 'Unknown'}: ${msg.text}`;
        messagesDiv.appendChild(p);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });
</script>

</body>
</html>
